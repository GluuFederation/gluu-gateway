title OAuth plugin configuration

loop Create Service&Route
konga->kong: Create service with url: "https://demo.com"
kong->konga: Response with service object
konga->kong: Create route with service_id
kong->konga: Response with response object
end

loop Create API(deprecated)
konga->kong: Create API with url: "https://demo.com"
kong->konga: Response with API object
end

alt New Client
    konga->oxd: Create client(setup_client)
    oxd->OP:
    OP->oxd:
    oxd->konga: Return with client credentials
    konga->konga_DB: Store client_credentials
    note over konga_DB
        oxd_id,
        client_id_of_oxd_id: used to show oxd e-comm report,
        setup_client_oxd_id: used to show oxd e-comm report,
        client_id,
        client_secret: used to update client_expire time.
    end note
else Use Existing Client
    note over konga
        User can use existing client credentials
        Enter oxd_id,
        Enter client_id_of_oxd_id: used to show oxd e-comm report,
        Enter setup_client_oxd_id: used to show oxd e-comm report,
        Enter client_id,
        Enter client_secret: used to update client_expire time.
    end note
    konga->konga_DB: Store client_credentials
end

konga->kong: Configure Gluu-OAuth2-Client plugin with [Service|Route|API|Global]
note over kong
Gluu-OAuth2-Client schema:
1. oxd_id
2. client_id
3. client_secret
4. op_server
5. oxd_http_url
6. mode {"OAUTH","UMA","MIX"}
7. anonymous
8. oauth_scope_expression
9. allow_oauth_scope_expression
end note
kong->kong_DB: Add Gluu-OAuth2
kong_DB->kong:
kong->konga: Return with gluu-oauth2 config details
