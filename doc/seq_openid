title Gluu Front Channel Auth + UMA

RP->Kong: Request to access web
Kong->OP: Get Authorization URL and Redirect to OP
note over RP, OP:
    Authenticate User: Username/Password
end note
OP->Kong: Return with Code
Kong<->OP: Get Token by Code
Kong<->OP: Get Userinfo by token
alt token and UMA enable=true
    Kong->OP: Request to resources
    OP->Kong: Return TICKET
    Kong<->OP: Get RPT by TICKET
    alt need_info
        Kong<->OP: Get need_info and claim gatering URL
        Kong<->OP: Redirect to claim gatering URL
        Kong->OP: Enter claim info
        Kong<->OP: Get Ticket
        Kong<->OP: Get RPT by TICKET
    end
    OP<->Kong: UMA RS Check Access
end
Kong->RP: Success with headers
note over RP,Kong:
HTTP_Kong_id_token_jwt
HTTP_Kong_userinfo_jwt
HTTP_Kong_userinfo
HTTP_Kong_id_token
HTTP_Kong_user_number
end note

RP->Kong: Logout
Kong<->OP: Logout
Kong->RP: